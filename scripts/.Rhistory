#matchedinquiries<- matchedinquiries %>% dplyr::select(Address,Zip_Code,timestamp_inquiry_sent_out)
dta<-dta%>% dplyr::select(Address,Zip_Code,timestamp_inquiry_sent_out,timestamp_response_received)
dta<- dta %>% distinct(.keep_all = TRUE)
dta$timestamp_inquiry_sent_out<-as.character(dta$timestamp_inquiry_sent_out)
dta$timestamp_response_received<-as.character(dta$timestamp_response_received)
dta3<-left_join(matchedinquiries,dta)
dta3 <- dta3 %>% group_by(Address,Zip_Code,timestamp_inquiry_sent_out) %>% mutate(n=n())
table(dta3$n)
#View(dta3 %>% filter(n>1))
haven::write_dta(dta3,"github/stores_prev/aux/toxic_discrimination_data_prep_2.dta")
##########################################################
# author: Ignacio Sarmiento-Barbieri
# based on Peter Christensen's code
##########################################################
#Clean the workspace
rm(list=ls())
cat("\014")
local({r <- getOption("repos"); r["CRAN"] <- "http://cran.r-project.org"; options(repos=r)}) #set repo
#Load Packages
pkg<-c("survival","dplyr","doMC","rgeos","spdep","sp","fastDummies","tidyr","stargazer")
lapply(pkg, require, character.only=T)
rm(pkg)
#
#Set WD local
setwd("~/Dropbox/Research/Toxic_Discrimination/github/Toxic_Discrimination/")
#Descriptive
dta_desc<-read.csv("views/descriptive_RSEI.csv")
dta_desc<-dta_desc[,2:4]
dta_desc[c(1,2,7,8),]<-dta_desc[c(1,2,7,8),]/1000
colnames(dta_desc)<-c("Q1","Q2-Q3","Q4")
#dta_desc<-round(dta_desc,2)
dta_desc<-format(round(dta_desc, digits=3), nsmall = 3)
for(j in 1:3) dta_desc[,j]<-trimws(dta_desc[,j])
dta_desc[2,] <-paste0("(",dta_desc[2,] ,")")
dta_desc[4,] <-paste0("(",dta_desc[4,] ,")")
dta_desc[6,] <-paste0("(",dta_desc[6,] ,")")
dta_desc[8,] <-paste0("(",dta_desc[8,] ,")")
dta_desc[10,]<-paste0("(",dta_desc[10,],")")
dta_desc[12,]<-paste0("(",dta_desc[12,],")")
dta_desc[14,]<-paste0("(",dta_desc[14,],")")
dta_desc[16,]<-paste0("(",dta_desc[16,],")")
dta_desc[18,]<-paste0("(",dta_desc[18,],")")
dta_desc[20,]<-paste0("(",dta_desc[20,],")")
dta_desc[22,]<-paste0("(",dta_desc[22,],")")
dta_desc[24,]<-paste0("(",dta_desc[24,],")")
dta_desc[26,]<-paste0("(",dta_desc[26,],")")
dta_desc[28,]<-paste0("(",dta_desc[28,],")")
dta_desc[30,]<-paste0("(",dta_desc[30,],")")
dta_desc[32,]<-paste0("(",dta_desc[32,],")")
dta_desc[34,]<-paste0("(",dta_desc[34,],")")
dta_desc[36,]<-paste0("(",dta_desc[36,],")")
dta_desc[38,]<-paste0("(",dta_desc[38,],")")
dta_desc$names<-NA
dta_desc$names[1]<-"Toxic Concentration (K)"
dta_desc$names[2]<-""
dta_desc$names[3]<-"Cancer Score"
dta_desc$names[4]<-""
dta_desc$names[5]<-"Non Cancer Score"
dta_desc$names[6]<-""
dta_desc$names[7]<-"Rent (K)"
dta_desc$names[8]<-""
dta_desc$names[9]<-"Single Family Home"
dta_desc$names[10]<-""
dta_desc$names[11]<-"Apartment"
dta_desc$names[12]<-""
dta_desc$names[13]<-"Multi Family"
dta_desc$names[14]<-""
dta_desc$names[15]<-"Other Bldg. Type"
dta_desc$names[16]<-""
dta_desc$names[17]<-"Bedrooms"
dta_desc$names[18]<-""
dta_desc$names[19]<-"Bathrooms"
dta_desc$names[20]<-""
dta_desc$names[21]<-"Sqft."
dta_desc$names[22]<-""
dta_desc$names[23]<-"Assault"
dta_desc$names[24]<-""
dta_desc$names[25]<-"Groceries"
dta_desc$names[26]<-""
dta_desc$names[27]<-"Share of Hispanics"
dta_desc$names[28]<-""
dta_desc$names[29]<-"Share of African American"
dta_desc$names[30]<-""
dta_desc$names[31]<-"Share of Whites"
dta_desc$names[32]<-""
dta_desc$names[33]<-"Poverty Rate"
dta_desc$names[34]<-""
dta_desc$names[35]<-"Unemployment Rate"
dta_desc$names[36]<-""
dta_desc$names[37]<-"Share of College Educated"
dta_desc$names[38]<-""
dta_desc<- dta_desc[,c("names","Q1","Q2-Q3","Q4")]
# # -----------------------------------------------------------------------
#Ttest
# # -----------------------------------------------------------------------
dta<-read.csv("views/descriptive_RSEI_ttest.csv")
colnames(dta)<-c("0th-25th","25th-75th","75th-100th")
dta<-round(dta, 4)
dta<-format(round(dta, digits=3), nsmall = 3)
for(j in 1:3) dta[,j]<-trimws(dta[,j])
dta
for(j in seq(1,37,by=2)){
for(k in 1:3){
value<-dta[j,k] #format(round(, 2), nsmall = 2, big.mark=",")
tscore<-abs(as.numeric(dta[j,k])/as.numeric(dta[j+1,k]))
dta[j,k] <-ifelse(tscore>=2.576, paste0(value,"***"),
ifelse(tscore>=1.96 & tscore<2.576, paste0(value ,"**"),
ifelse(tscore>=1.645 & tscore<1.96, paste0(value,"*"),paste0(value ))))
dta[j+1,k] <-paste0("(",dta[j+1,k],")") #for standard errors
}
}
dta<-dta[,c(2,3)]
# Bind rows ----------------------------------------------------------------
dta_bind<-bind_cols(dta_desc,dta)
stargazer(dta_bind,summary=FALSE,type="text", rownames = FALSE,out="views/descriptive_RSEI.tex")
##########################################################
# author: Ignacio Sarmiento-Barbieri
##########################################################
#Clean the workspace
rm(list=ls())
cat("\014")
local({r <- getOption("repos"); r["CRAN"] <- "http://cran.r-project.org"; options(repos=r)}) #set repo
#Load Packages
pkg<-c("dplyr","haven")
lapply(pkg, require, character.only=T)
rm(pkg)
minority_dta<-read_dta("../stores/aux/interquartile_toxconc_minority_bootcl.dta")
colnames(minority_dta)<-c("lci","or","uci","obs","c_mean","deciles")
minority_dta$race = "minority"
black_dta<-read_dta("../stores/aux/interquartile_toxconc_AA_bootcl.dta")
colnames(black_dta)<-c("lci","or","uci","obs","c_mean","deciles")
black_dta$race = "black"
hispanic_dta<-read_dta("../stores/aux/interquartile_toxconc_Hisp_bootcl.dta")
colnames(hispanic_dta)<-c("lci","or","uci","obs","c_mean","deciles")
hispanic_dta$race = "hispanic"
dta<-bind_rows(minority_dta,black_dta,hispanic_dta)
setwd("~/Dropbox/Research/Toxic_Discrimination/github/Toxic_Discrimination/scripts/Rscripts")
setwd("~/Dropbox/Research/Toxic_Discrimination/github/Toxic_Discrimination/scripts/)
""
""
setwd("~/Dropbox/Research/Toxic_Discrimination/github/Toxic_Discrimination/scripts/")
##########################################################
# author: Ignacio Sarmiento-Barbieri
##########################################################
#Clean the workspace
rm(list=ls())
cat("\014")
local({r <- getOption("repos"); r["CRAN"] <- "http://cran.r-project.org"; options(repos=r)}) #set repo
#Load Packages
pkg<-c("dplyr","haven")
lapply(pkg, require, character.only=T)
rm(pkg)
minority_dta<-read_dta("../stores/aux/interquartile_toxconc_minority_bootcl.dta")
colnames(minority_dta)<-c("lci","or","uci","obs","c_mean","deciles")
minority_dta$race = "minority"
black_dta<-read_dta("../stores/aux/interquartile_toxconc_AA_bootcl.dta")
colnames(black_dta)<-c("lci","or","uci","obs","c_mean","deciles")
black_dta$race = "black"
hispanic_dta<-read_dta("../stores/aux/interquartile_toxconc_Hisp_bootcl.dta")
colnames(hispanic_dta)<-c("lci","or","uci","obs","c_mean","deciles")
hispanic_dta$race = "hispanic"
dta<-bind_rows(minority_dta,black_dta,hispanic_dta)
##########################################################
# author: Ignacio Sarmiento-Barbieri
##########################################################
#Clean the workspace
rm(list=ls())
cat("\014")
local({r <- getOption("repos"); r["CRAN"] <- "http://cran.r-project.org"; options(repos=r)}) #set repo
#Load Packages
pkg<-c("dplyr","haven")
lapply(pkg, require, character.only=T)
rm(pkg)
minority_dta<-read_dta("../stores/aux/interquartile_toxconc_minority_bootcl.dta")
colnames(minority_dta)<-c("lci","or","uci","obs","c_mean","deciles")
minority_dta$race = "minority"
black_dta<-read_dta("../stores/aux/interquartile_toxconc_AA_bootcl.dta")
colnames(black_dta)<-c("lci","or","uci","obs","c_mean","deciles")
black_dta$race = "black"
hispanic_dta<-read_dta("../stores/aux/interquartile_toxconc_Hisp_bootcl.dta")
colnames(hispanic_dta)<-c("lci","or","uci","obs","c_mean","deciles")
hispanic_dta$race = "hispanic"
dta<-bind_rows(minority_dta,black_dta,hispanic_dta)
dta<- dta %>% mutate(mean_r_white=1/c_mean)
View(dta)
rel_risk<-read_dta("../stores/aux/rel_risk_quartile.dta")
rel_risk<-zap_formats(rel_risk)
colnames(rel_risk)[1]<-"relative_risk"
colnames(rel_risk)[3]<-"deciles"
rel_risk$deciles<-rep(c(1,2,3),3)
dta<-left_join(dta,rel_risk)
##########################################################
# author: Ignacio Sarmiento-Barbieri
##########################################################
#Clean the workspace
rm(list=ls())
cat("\014")
local({r <- getOption("repos"); r["CRAN"] <- "http://cran.r-project.org"; options(repos=r)}) #set repo
#Load Packages
pkg<-c("dplyr","haven")
lapply(pkg, require, character.only=T)
rm(pkg)
minority_dta<-read_dta("../stores/aux/interquartile_toxconc_minority_bootcl.dta")
colnames(minority_dta)<-c("lci","or","uci","obs","c_mean","deciles")
minority_dta$race = "minority"
black_dta<-read_dta("../stores/aux/interquartile_toxconc_AA_bootcl.dta")
colnames(black_dta)<-c("lci","or","uci","obs","c_mean","deciles")
black_dta$race = "black"
hispanic_dta<-read_dta("../stores/aux/interquartile_toxconc_Hisp_bootcl.dta")
colnames(hispanic_dta)<-c("lci","or","uci","obs","c_mean","deciles")
hispanic_dta$race = "hispanic"
dta<-bind_rows(minority_dta,black_dta,hispanic_dta)
rel_risk<-read_dta("../stores/aux/rel_risk_quartile.dta")
rel_risk<-zap_formats(rel_risk)
colnames(rel_risk)[1]<-"relative_risk"
colnames(rel_risk)[3]<-"deciles"
rel_risk$deciles<-rep(c(1,2,3),3)
dta<-left_join(dta,rel_risk)
##########################################################
# author: Ignacio Sarmiento-Barbieri
##########################################################
#Clean the workspace
rm(list=ls())
cat("\014")
local({r <- getOption("repos"); r["CRAN"] <- "http://cran.r-project.org"; options(repos=r)}) #set repo
#Load Packages
pkg<-c("dplyr","haven")
lapply(pkg, require, character.only=T)
rm(pkg)
minority_dta<-read_dta("../stores/aux/interquartile_toxconc_minority_bootcl.dta")
colnames(minority_dta)<-c("lci","or","uci","obs","c_mean","deciles")
minority_dta$race = "minority"
black_dta<-read_dta("../stores/aux/interquartile_toxconc_AA_bootcl.dta")
colnames(black_dta)<-c("lci","or","uci","obs","c_mean","deciles")
black_dta$race = "black"
hispanic_dta<-read_dta("../stores/aux/interquartile_toxconc_Hisp_bootcl.dta")
colnames(hispanic_dta)<-c("lci","or","uci","obs","c_mean","deciles")
hispanic_dta$race = "hispanic"
dta<-bind_rows(minority_dta,black_dta,hispanic_dta)
rel_risk<-read_dta("../stores/aux/rel_risk_quartile.dta")
rel_risk<-zap_formats(rel_risk)
colnames(rel_risk)[1]<-"relative_risk"
colnames(rel_risk)[3]<-"deciles"
rel_risk$deciles<-rep(c(1,2,3),3)
dta<-left_join(dta,rel_risk)
dta<- dta %>% mutate(mean_r_white=1/c_mean)
dta<- dta %>% mutate(inq_per_response=mean_r_white/relative_risk)
dta_mean_r_white<-dta %>% dplyr::select(race,mean_r_white)
dta_mean_r_white<-dta_mean_r_white[c(1:3),]
dta_mean_r_white$race<-"White"
colnames(dta_mean_r_white)[2]<-"inq_per_response"
dta_wide<-dta %>% dplyr::select(race,inq_per_response)
dta_wide<-bind_rows(dta_mean_r_white,dta_wide)
dta_wide$deciles<-rep(c(1,2,3),4)
dta_wide<-dta_wide %>% tidyr::pivot_wider(names_from=deciles,values_from=inq_per_response)
dta_wide<-dta_wide %>% mutate(dif=`1`-`3`)
dta_wide$race<-c("White","Minority","African American","Hispanic/LatinX ")
library("xtable")
print(xtable(dta_wide), include.rownames = FALSE, include.colnames = FALSE, sanitize.text.function = I)
dta<- dta %>% mutate(mean_r_white=1/c_mean)
dta<- dta %>% mutate(inq_per_response=mean_r_white/relative_risk)
dta_mean_r_white<-dta %>% dplyr::select(race,mean_r_white)
dta_mean_r_white<-dta_mean_r_white[c(1:2),]
dta_mean_r_white$race<-"White"
colnames(dta_mean_r_white)[2]<-"inq_per_response"
dta_wide<-dta %>% dplyr::select(race,inq_per_response)
dta_wide<-bind_rows(dta_mean_r_white,dta_wide)
dta_wide$deciles<-rep(c(1,2),4)
dta_wide<-dta_wide %>% tidyr::pivot_wider(names_from=deciles,values_from=inq_per_response)
dta_wide<-dta_wide %>% mutate(dif=`2`-`1`)
dta_wide$race<-c("White","Minority","African American","Hispanic/LatinX ")
colnames(dta_wide)<-c("race","less1","more1","dif")
dta_wide<- dta_wide[,c("race","more1","less1","dif")]
print(xtable(dta_wide), include.rownames = FALSE, include.colnames = FALSE, sanitize.text.function = I)
##########################################################
# author: Ignacio Sarmiento-Barbieri
##########################################################
#Clean the workspace
rm(list=ls())
cat("\014")
local({r <- getOption("repos"); r["CRAN"] <- "http://cran.r-project.org"; options(repos=r)}) #set repo
#Load Packages
pkg<-c("dplyr","haven")
lapply(pkg, require, character.only=T)
rm(pkg)
minority_dta<-read_dta("../stores/aux/interquartile_toxconc_minority_bootcl.dta")
colnames(minority_dta)<-c("lci","or","uci","obs","c_mean","deciles")
minority_dta$race = "minority"
black_dta<-read_dta("../stores/aux/interquartile_toxconc_AA_bootcl.dta")
colnames(black_dta)<-c("lci","or","uci","obs","c_mean","deciles")
black_dta$race = "black"
hispanic_dta<-read_dta("../stores/aux/interquartile_toxconc_Hisp_bootcl.dta")
colnames(hispanic_dta)<-c("lci","or","uci","obs","c_mean","deciles")
hispanic_dta$race = "hispanic"
dta<-bind_rows(minority_dta,black_dta,hispanic_dta)
rel_risk<-read_dta("../stores/aux/rel_risk_quartile.dta")
rel_risk<-zap_formats(rel_risk)
colnames(rel_risk)[1]<-"relative_risk"
colnames(rel_risk)[3]<-"deciles"
rel_risk$deciles<-rep(c(1,2,3),3)
dta<-left_join(dta,rel_risk)
#dta$relative_risk<-c(0.67864963 , 0.7870416, 1.1063163)
dta<- dta %>% mutate(mean_r_white=1/c_mean)
dta<- dta %>% mutate(inq_per_response=mean_r_white/relative_risk)
dta_mean_r_white<-dta %>% dplyr::select(race,mean_r_white)
dta_mean_r_white<-dta_mean_r_white[c(1:3),]
dta_mean_r_white$race<-"White"
colnames(dta_mean_r_white)[2]<-"inq_per_response"
dta_wide<-dta %>% dplyr::select(race,inq_per_response)
dta_wide<-bind_rows(dta_mean_r_white,dta_wide)
dta_wide$deciles<-rep(c(1,2,3),4)
dta_wide<-dta_wide %>% tidyr::pivot_wider(names_from=deciles,values_from=inq_per_response)
dta_wide<-dta_wide %>% mutate(dif=`1`-`3`)
dta_wide$race<-c("White","Minority","African American","Hispanic/LatinX ")
library("xtable")
print(xtable(dta_wide), include.rownames = FALSE, include.colnames = FALSE, sanitize.text.function = I)
# # -----------------------------------------------------------------------
# # -----------------------------------------------------------------------
# Distance ----------------------------------------------------------------
# # -----------------------------------------------------------------------
# # -----------------------------------------------------------------------
minority_dta<-read_dta("../stores/aux/distance_minority_bootcl.dta")
colnames(minority_dta)<-c("lci","or","uci","obs","c_mean","deciles")
minority_dta$race = "minority"
black_dta<-read_dta("../stores/aux/distance_race_afam_bootcl.dta")
colnames(black_dta)<-c("lci","or","uci","obs","c_mean","deciles")
black_dta$race = "black"
hispanic_dta<-read_dta("../stores/aux/distance_race_hispanic_bootcl.dta")
colnames(hispanic_dta)<-c("lci","or","uci","obs","c_mean","deciles")
hispanic_dta$race = "hispanic"
dta<-bind_rows(minority_dta,black_dta,hispanic_dta)
rel_risk<-read_dta("../stores/aux/rel_risk_distance.dta")
rel_risk<-zap_formats(rel_risk)
colnames(rel_risk)[1]<-"relative_risk"
colnames(rel_risk)[3]<-"deciles"
rel_risk$deciles<-rep(c(1,2),3)
dta<-left_join(dta,rel_risk)
#dta$relative_risk<-c(0.67864963 , 0.7870416, 1.1063163)
dta<- dta %>% mutate(mean_r_white=1/c_mean)
dta<- dta %>% mutate(inq_per_response=mean_r_white/relative_risk)
dta_mean_r_white<-dta %>% dplyr::select(race,mean_r_white)
dta_mean_r_white<-dta_mean_r_white[c(1:2),]
dta_mean_r_white$race<-"White"
colnames(dta_mean_r_white)[2]<-"inq_per_response"
dta_wide<-dta %>% dplyr::select(race,inq_per_response)
dta_wide<-bind_rows(dta_mean_r_white,dta_wide)
dta_wide$deciles<-rep(c(1,2),4)
dta_wide<-dta_wide %>% tidyr::pivot_wider(names_from=deciles,values_from=inq_per_response)
dta_wide<-dta_wide %>% mutate(dif=`2`-`1`)
dta_wide$race<-c("White","Minority","African American","Hispanic/LatinX ")
colnames(dta_wide)<-c("race","less1","more1","dif")
dta_wide<- dta_wide[,c("race","more1","less1","dif")]
print(xtable(dta_wide), include.rownames = FALSE, include.colnames = FALSE, sanitize.text.function = I)
?print
##########################################################
# author: Ignacio Sarmiento-Barbieri
##########################################################
#Clean the workspace
rm(list=ls())
cat("\014")
local({r <- getOption("repos"); r["CRAN"] <- "http://cran.r-project.org"; options(repos=r)}) #set repo
#Load Packages
pkg<-c("dplyr","haven")
lapply(pkg, require, character.only=T)
rm(pkg)
minority_dta<-read_dta("../stores/aux/interquartile_toxconc_minority_bootcl.dta")
colnames(minority_dta)<-c("lci","or","uci","obs","c_mean","deciles")
minority_dta$race = "minority"
black_dta<-read_dta("../stores/aux/interquartile_toxconc_AA_bootcl.dta")
colnames(black_dta)<-c("lci","or","uci","obs","c_mean","deciles")
black_dta$race = "black"
hispanic_dta<-read_dta("../stores/aux/interquartile_toxconc_Hisp_bootcl.dta")
colnames(hispanic_dta)<-c("lci","or","uci","obs","c_mean","deciles")
hispanic_dta$race = "hispanic"
dta<-bind_rows(minority_dta,black_dta,hispanic_dta)
rel_risk<-read_dta("../stores/aux/rel_risk_quartile.dta")
rel_risk<-zap_formats(rel_risk)
colnames(rel_risk)[1]<-"relative_risk"
colnames(rel_risk)[3]<-"deciles"
rel_risk$deciles<-rep(c(1,2,3),3)
dta<-left_join(dta,rel_risk)
#dta$relative_risk<-c(0.67864963 , 0.7870416, 1.1063163)
dta<- dta %>% mutate(mean_r_white=1/c_mean)
dta<- dta %>% mutate(inq_per_response=mean_r_white/relative_risk)
dta_mean_r_white<-dta %>% dplyr::select(race,mean_r_white)
dta_mean_r_white<-dta_mean_r_white[c(1:3),]
dta_mean_r_white$race<-"White"
colnames(dta_mean_r_white)[2]<-"inq_per_response"
dta_wide<-dta %>% dplyr::select(race,inq_per_response)
dta_wide<-bind_rows(dta_mean_r_white,dta_wide)
dta_wide$deciles<-rep(c(1,2,3),4)
dta_wide<-dta_wide %>% tidyr::pivot_wider(names_from=deciles,values_from=inq_per_response)
dta_wide<-dta_wide %>% mutate(dif=`1`-`3`)
dta_wide$race<-c("White","Minority","African American","Hispanic/LatinX ")
library("xtable")
print(xtable(dta_wide), include.rownames = FALSE, include.colnames = FALSE, sanitize.text.function = I,file="../views/tableA10_b.tex"))
# # -----------------------------------------------------------------------
# # -----------------------------------------------------------------------
# Distance ----------------------------------------------------------------
# # -----------------------------------------------------------------------
# # -----------------------------------------------------------------------
minority_dta<-read_dta("../stores/aux/distance_minority_bootcl.dta")
colnames(minority_dta)<-c("lci","or","uci","obs","c_mean","deciles")
minority_dta$race = "minority"
black_dta<-read_dta("../stores/aux/distance_race_afam_bootcl.dta")
colnames(black_dta)<-c("lci","or","uci","obs","c_mean","deciles")
black_dta$race = "black"
hispanic_dta<-read_dta("../stores/aux/distance_race_hispanic_bootcl.dta")
colnames(hispanic_dta)<-c("lci","or","uci","obs","c_mean","deciles")
hispanic_dta$race = "hispanic"
dta<-bind_rows(minority_dta,black_dta,hispanic_dta)
rel_risk<-read_dta("../stores/aux/rel_risk_distance.dta")
rel_risk<-zap_formats(rel_risk)
colnames(rel_risk)[1]<-"relative_risk"
colnames(rel_risk)[3]<-"deciles"
rel_risk$deciles<-rep(c(1,2),3)
dta<-left_join(dta,rel_risk)
#dta$relative_risk<-c(0.67864963 , 0.7870416, 1.1063163)
dta<- dta %>% mutate(mean_r_white=1/c_mean)
dta<- dta %>% mutate(inq_per_response=mean_r_white/relative_risk)
dta_mean_r_white<-dta %>% dplyr::select(race,mean_r_white)
dta_mean_r_white<-dta_mean_r_white[c(1:2),]
dta_mean_r_white$race<-"White"
colnames(dta_mean_r_white)[2]<-"inq_per_response"
dta_wide<-dta %>% dplyr::select(race,inq_per_response)
dta_wide<-bind_rows(dta_mean_r_white,dta_wide)
dta_wide$deciles<-rep(c(1,2),4)
dta_wide<-dta_wide %>% tidyr::pivot_wider(names_from=deciles,values_from=inq_per_response)
dta_wide<-dta_wide %>% mutate(dif=`2`-`1`)
dta_wide$race<-c("White","Minority","African American","Hispanic/LatinX ")
colnames(dta_wide)<-c("race","less1","more1","dif")
dta_wide<- dta_wide[,c("race","more1","less1","dif")]
print(xtable(dta_wide), include.rownames = FALSE, include.colnames = FALSE, sanitize.text.function = I, file="../views/tableA10_b.tex")
##########################################################
# author: Ignacio Sarmiento-Barbieri
##########################################################
#Clean the workspace
rm(list=ls())
cat("\014")
local({r <- getOption("repos"); r["CRAN"] <- "http://cran.r-project.org"; options(repos=r)}) #set repo
#Load Packages
pkg<-c("dplyr","haven")
lapply(pkg, require, character.only=T)
rm(pkg)
minority_dta<-read_dta("../stores/aux/interquartile_toxconc_minority_bootcl.dta")
colnames(minority_dta)<-c("lci","or","uci","obs","c_mean","deciles")
minority_dta$race = "minority"
black_dta<-read_dta("../stores/aux/interquartile_toxconc_AA_bootcl.dta")
colnames(black_dta)<-c("lci","or","uci","obs","c_mean","deciles")
black_dta$race = "black"
hispanic_dta<-read_dta("../stores/aux/interquartile_toxconc_Hisp_bootcl.dta")
colnames(hispanic_dta)<-c("lci","or","uci","obs","c_mean","deciles")
hispanic_dta$race = "hispanic"
dta<-bind_rows(minority_dta,black_dta,hispanic_dta)
rel_risk<-read_dta("../stores/aux/rel_risk_quartile.dta")
rel_risk<-zap_formats(rel_risk)
colnames(rel_risk)[1]<-"relative_risk"
colnames(rel_risk)[3]<-"deciles"
rel_risk$deciles<-rep(c(1,2,3),3)
dta<-left_join(dta,rel_risk)
#dta$relative_risk<-c(0.67864963 , 0.7870416, 1.1063163)
dta<- dta %>% mutate(mean_r_white=1/c_mean)
dta<- dta %>% mutate(inq_per_response=mean_r_white/relative_risk)
dta_mean_r_white<-dta %>% dplyr::select(race,mean_r_white)
dta_mean_r_white<-dta_mean_r_white[c(1:3),]
dta_mean_r_white$race<-"White"
colnames(dta_mean_r_white)[2]<-"inq_per_response"
dta_wide<-dta %>% dplyr::select(race,inq_per_response)
dta_wide<-bind_rows(dta_mean_r_white,dta_wide)
dta_wide$deciles<-rep(c(1,2,3),4)
dta_wide<-dta_wide %>% tidyr::pivot_wider(names_from=deciles,values_from=inq_per_response)
dta_wide<-dta_wide %>% mutate(dif=`1`-`3`)
dta_wide$race<-c("White","Minority","African American","Hispanic/LatinX ")
library("xtable")
print(xtable(dta_wide), include.rownames = FALSE, include.colnames = FALSE, sanitize.text.function = I,file="../views/tableA10_a.tex")
# # -----------------------------------------------------------------------
# # -----------------------------------------------------------------------
# Distance ----------------------------------------------------------------
# # -----------------------------------------------------------------------
# # -----------------------------------------------------------------------
minority_dta<-read_dta("../stores/aux/distance_minority_bootcl.dta")
colnames(minority_dta)<-c("lci","or","uci","obs","c_mean","deciles")
minority_dta$race = "minority"
black_dta<-read_dta("../stores/aux/distance_race_afam_bootcl.dta")
colnames(black_dta)<-c("lci","or","uci","obs","c_mean","deciles")
black_dta$race = "black"
hispanic_dta<-read_dta("../stores/aux/distance_race_hispanic_bootcl.dta")
colnames(hispanic_dta)<-c("lci","or","uci","obs","c_mean","deciles")
hispanic_dta$race = "hispanic"
dta<-bind_rows(minority_dta,black_dta,hispanic_dta)
rel_risk<-read_dta("../stores/aux/rel_risk_distance.dta")
rel_risk<-zap_formats(rel_risk)
colnames(rel_risk)[1]<-"relative_risk"
colnames(rel_risk)[3]<-"deciles"
rel_risk$deciles<-rep(c(1,2),3)
dta<-left_join(dta,rel_risk)
#dta$relative_risk<-c(0.67864963 , 0.7870416, 1.1063163)
dta<- dta %>% mutate(mean_r_white=1/c_mean)
dta<- dta %>% mutate(inq_per_response=mean_r_white/relative_risk)
dta_mean_r_white<-dta %>% dplyr::select(race,mean_r_white)
dta_mean_r_white<-dta_mean_r_white[c(1:2),]
dta_mean_r_white$race<-"White"
colnames(dta_mean_r_white)[2]<-"inq_per_response"
dta_wide<-dta %>% dplyr::select(race,inq_per_response)
dta_wide<-bind_rows(dta_mean_r_white,dta_wide)
dta_wide$deciles<-rep(c(1,2),4)
dta_wide<-dta_wide %>% tidyr::pivot_wider(names_from=deciles,values_from=inq_per_response)
dta_wide<-dta_wide %>% mutate(dif=`2`-`1`)
dta_wide$race<-c("White","Minority","African American","Hispanic/LatinX ")
colnames(dta_wide)<-c("race","less1","more1","dif")
dta_wide<- dta_wide[,c("race","more1","less1","dif")]
print(xtable(dta_wide), include.rownames = FALSE, include.colnames = FALSE, sanitize.text.function = I, file="../views/tableA10_b.tex")
